# QA CHECK Table (path: . . ./QA-DKRZ/tables/project/CMIP5/cmip5_flags.conf)

#   Description:
#   Any text following the # char is a comment.
#   Each deteced incident is handled by a directive on its own.
#   Directives are specified by tokens within groups indicated by braces {}.
#
#  Brace Operation:
#  A nested brace inherits the contents of the one it is embedded. The
#  hierarchy of braces is tree-like with unlimited number of parallel
#  branches as well as vertical branching. Thus, the tip of a branch
#  inherits every item from the parent down the crotches to the root.
#  The braces {} of the lowest level may be omitted as well as a comma around braces.
#  Each higher-level branch, i.e. contents of a brace,
#  is a specialisation to its parent. A brace may contain multiple
#  comma-separated items. If the L-value, i.e. the word 'key'
#  in 'key=value', is identical to a lower level one, then the
#  lower one is not inherited. Inheritance of an item may also be inhibited by
#  the macro "D(item). The macro is applied solely to L-values.
#  The hierarchy of braces is eventually expanded into unrelated strings.
#  Example:
#     simple:  given: a,{b,c},{d,e},f
#             result: 'a,f', 'a,b,c,f', 'd,e,a,f'
#  elaborate: given: a,b=1{x=v{D(x),y,b=2}},{u,v},w
#             result: 'a,b=1,w', 'x=v,a,b=1,w', 'y,b=2,a,w', 'u,v,a,b=1,w,'

#   Key words: L1, L2, L3, D, EM, VR, PT, flag, var, V=value, R=record
#   Level:    L1 Notify incidents. Continue unrestricted.
#                The default for omitted level of severeness.
#             L2 Continue checking to the end of the file. Then, lock processing of the current variable.
#             L3 Stop after completion of meta-data checks. Lock processing of current variable.
#             L4 Stop immediately and shutdown the QA session (no locks).
#   Table:    Variable Requirements Table (VR), Project Table (PT)
#   Flag:     Must match in the QA.cpp class.
#   Task:     Email notification (EM), discard the check/test (D)
#   Variable: A list of comma-separated acronyms of variables; directive is only applied to the variable(s).
#   Value:    Constraining value, e.g. {flag,D,V=0,var} discards a test for variable var only if value=0
#   Record:   Record(s), i.e. data at a time value, may be excluded from checking. Single records
#             as well as ranges, e.g. 1-12, may be provided.
#             Note: counting of records starts with number one.
#   Default: {VR,L1}, {PT,L2,EM}, {L3,EM}

#   Force unique behaviour (e.g. for testing). Please, unmark the comment #.
#   NOTE_ALWAYS {group1}, {group2}, . . .

# NOTE_ALWAYS {L1}, {10,D}

# Example:
# descriptive text & 32_2,{L1,tas,D,VR},{PT,L2,EM}

# Time/Data (per time value):
Negative time step & R1,L2,EM
Missing time step & R2,L2,EM
Identical time step & R4,L2,EM
Negative/zero time bounds range & R8,L2,EM
Overlapping time bounds ranges & R16,L2,EM
Gap between time bounds ranges & R32,L2,EM
Found a record entirely with filling value & R100
Found a record entirely with constant value & R200,D,V=0,rsus,rsds,sund,snw,snc,snd,snm,clivi}
Failed outlier test: global minimum & R400,D
Failed outlier test: global maximum & R800,D
Undefined standard deviation & R1600
Suspecting a replicated record & R3200,D #,{D,rsus,rsds,sund}
Infinite (Inf) or not-a-number (NaN) & R6400,L2,EM

# Directory and Filename Structure (1)
Directory structure does not match global attributes & 1_1
Directory structure lacks global attribute & 1_2
Variable name in filename does not match any variable in the file & 1_3
Filename structure with syntax error & 1_4
Filename does not match file attributes & 1_5
The time-stamp in the filename is misaligend & 1_6
Invalid time-stamp in the filename & 1_7,L2
Period in filename of invalid range & 1_8
Period in filename of incorrect format & 1_9
Period in filename aligned incorrectly for a season & 1_10
Time ambiguity in the ensemble of files & 1_11,L2
Unspecific netCDF or time failure & 1_12,L2
A period is required in the filename & 1_13

# Required attributes (2)
Global attribute <name>: missing required value=<value> & 2_1
Global attribute <name>: unmatched required value=<value> & 2_2
Missing global attribute <name> & 2_3

# Variables (3)
Variable <name> not found in the standard table & 3_1
<variable>:<dimension>: output name & {3_2,VR},{3_2,L2,PT}
<variable>:<dimension>: standard name & {3_3,VR},{3_3,L2,PT}
<variable>:<dimension>: long name & {3_4,VR},{3_4,L2,PT}
<variable>:<dimension>: axis & {3_5,VR},{3_5,L2,PT}
<variable>:<dimension>: checksum & {3_6,VR},{3_6,L2,PT}
# Note: Indicates a change in the layering or model grid.
<variable>:<dimension>: units & {3_7,VR},{3_7,L2,PT}
<variable>:<dimension>: size & {3_8,VR},{3_8,L2,PT}
time:units: missing key string in the attribute 'PERIOD since' & 3_9,L2
# Note: PERIOD must always indicate 'days' for CMIP5.
time:units: different reference dates & 3_10
# Note: L1, because the calculated date may be actually correct.
Variable representation of a dimension: number of bounds do not match those of the table & {3_11,VR},{3_11,L2,PT}
Variable representation of a dimension: values of bounds do not match those of the table & {3_12,VR},{3_12,L2,PT}
Variable specified in the coordinate attribute has no units & {3_13,VR},{3_13,L2,PT}
Missing variable in sub-temporal file & 3_14
New variable in sub-temporal file & 3_15
Fixed variable depends on time & 3_16,L3

# Dimensions (4)
Dimension not found in the standard table & 4_1,L2
Corrupt standard table for dimensions: wrong number of columns & 4_2,L3
Dimension from the table not found in the file & 4_3,L3
<variable>: standard name conflict & 4_4
<variable>: long name conflict & 4_5
<variable>: units conflict & 4_6
<variable>: cell_methods conflict & 4_7
<variable>: type conflict & 4_8
<variable>: cell_measures conflict & 4_9
<variable>. incorrect coordinate attribute & 4_10
<variable>: type check discarded, because not specified in the MIP table & 4_11
<variable>: name matches only for case-insensitivity & 4_12

# Auxiliaries (5), note: non-target variables
Std. output table requests an auxiliary which is missing in the file & 5_5

# Data (6)
Data set entirely of const value & 6_1
Data set entirely of _FillValue & 6_2
All time values with identical data & 6_3
Time value before the first time-table range & 6_4,L2
Time value after the last time-table range & 6_5,L2
Time value does not match time-table value & 6_6,L2
Too many time values compared to the time-table & 6_7,L2
Suspicion of fractional data range for units [%] & 6_8
Suspicion of percentage data range for units [1] & 6_9
Overlapping time bounds across files & 6_10
Gap between time bounds across files & 6_11
Overlapping time values across files & 6_12
Gap between time values across files & 6_13,L2
Identical time values across files & 6_14,L2
Variable without any data & 73,L2

# Tables (7)
Could not open the CMIP5 standard_ouput table & 41,L3
MIP table not found in the standard table & 42,L3
Missing column(s) in the standard table & 43,L3
Invalid MIP table name in CMIP5 attributes & 46_8
Diverging MIP table name in attribute and filename & 46_9
Table sheet for dimensions not found in the CMIP5 standard output table & 49,L3
Corrupt table sheet for dimensions: wrong number of columns & 50,L3
Table sheet for dimensions: missing value in column 'bounds' & 51
Project table is permanently locked & 54_1,L3
Could not create project table & 54_2,L3
Could not lock project table & 54_3,L3
Corrupt project table: variable & 55_1,L3
Corrupt project table: dimension & 55_2,L3
Corrupt project table: auxiliary & 55_3,L3
No path to tables found. Check your configuration file, please & 57,L3

# Changes between sub-temporal files (8)
Could not create a project table & 8_1,L3
Could not lock the project table & 8_2
Project table is locked for more than 1/2 hour & 8_3,L3
Auxiliary is missing in sub-temporal file & 8_4
Additional auxiliary <name> in sub-temporal file & 8_5
Auxiliary <name>: new attribute <name> for sub-temporal file & 8_6
Auxiliary <name>: attribute <name> is missing in sub-temporal file & 8_7, L1
Auxiliary <name>: attribute <name>: changed value in sub-temporal file & 8_8

# Miscellaneous (9)
Multiple output fields (variables) in the file & 9_1
Status: apparently in progress & 9_2

# generated by the qa-DKRZ script
Found empty directory & M1
Found broken link & M2
Found empty data file & M3
No permission to read NetCDF file & M4,L2
Found ambiguities in the sequence of sub-temporal files & M5,L2
Found invalid filename & M6,L2
Checksum changed, but the creation_date remained the same & M7,L2
Checksum changed, but the tracking_id remained the same & M8,L2
