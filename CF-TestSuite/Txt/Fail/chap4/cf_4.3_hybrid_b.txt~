netcdf cf_4.3_hybrid_b {
dimensions:
   lev = 3 ;
   lat = 3 ;
   lon = 4 ;

variables:
   float lat(lat) ;
      lat:long_name = "latitude" ;
      lat:units = "degrees_north" ;
      lat:standard_name = "latitude" ;
      lat:axis="Y" ;
   float lon(lon) ;
      lon:long_name = "longitude" ;
      lon:units = "degrees_east" ;
      lon:standard_name = "longitude" ;
      lon:axis="X" ;
   double ap(lev) ;
      ap:long_name = "vertical coordinate formula term: ap(k)" ;
      ap:units = "Pa" ;
      ap:comment = "cannot be detected as missing in lev:formula_terms" ;
   double b(lev) ;
      b:long_name = "vertical coordinate formula term: b(k)" ;
   float sap(lat, lon) ;
      sap:standard_name = "surface_air_pressure" ;
      sap:long_name = "Surface Air Pressure" ;
      sap:units = "Pa" ;

   float lev(lev) ;
      lev:long_name = "hybrid sigma pressure coordinate" ;
      lev:positive = "down" ;
      lev:standard_name = "atmosphere_hybrid_sigma_pressure_coordinate" ;
      lev:formula = "p = a + b*ps" ;
      lev:formula_terms = "ap: ax b: b ps: sap" ;
      lev:comment = "invalid: undefined variable in formula_terms" ;

// global attributes:
   :comment="Atmosphere sigma coordinate" ;
   :Conventions = "CF-1.4" ;

data:

lat = 1., 2., 3.;
lon = 1., 2., 3., 4.;
lev = 2., 4., 6.;
ap  = 1., 2., 3. ;
b   = 1., 2., 3. ;
sap = 1., 2., 3., 4., 5., 6., 7., 8., 9., 10., 11., 12. ;

}
